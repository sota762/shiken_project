{% extends 'base.html' %}


{% block title %}成績一覧{% endblock %}
{% block contents %}
    <h1>成績一覧</h1>
    <form method="get">
      <input type="text" name="q" placeholder="検索...">
      <button type="submit">検索</button>
    </form>

    {% if searchscore %}
        <ul>
        {% for item in searchscore %}
            <li>{{ item.score }}</li>
        {% endfor %}
        </ul>
    {% else %}
        <p>検索結果はありません。</p>
    {% endif %}
    <form method="get" action="{% url 'testapp:score_list' %}">
    <label for="category">科目選択：</label>
    <select name="category" id="category" onchange="this.form.submit()">
        <option value="">すべての科目</option>
        {% for value,name in categories %}
        <option value="{{ value }}"  {% if value|stringformat:'s' == selected_category %}selected{% endif %}>
          {{ name }}
            </option>
        {% endfor %}
    </select>
</form>
    <h5 style="text-align : right">
      <a href="{% url 'testapp:createscore' %}"
      >成績登録
      </a>
    </h5>
    {% if scores %}
    <h1>{{ selected_category_label }} の成績一覧</h1>
    {% else %}
    <h1>存在しません</h1>
    {% endif %}

      <table class="table table-striped table-hover table-bordered">
        <thead>
          <tr>
            <th>科目名</th>
            <th>点数</th>
            <th>登録日時</th>
            <th>選択</th>
          </tr>
        </thead>
        {% for score in scores %}
        <tr>
          <td>{{ score.get_category_display  }}</td>
          <td>{{ score.score }}点</td>
          <td>{{ score.posted_at }}</td>
          <td>
            <form method="post" action="{% url 'testapp:score_delete' score.id %}" style="display: inline;">
              {% csrf_token %}
              <button type="submit">削除</button>
            </form>
          </td>

        </tr>
        {% endfor %}
      </table>
  
  {% endblock %}